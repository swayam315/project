<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>MockAI - Master Your Interview</title>
    
    <!-- React & ReactDOM -->
    <script src="https://unpkg.com/react@18/umd/react.development.js" crossorigin></script>
    <script src="https://unpkg.com/react-dom@18/umd/react-dom.development.js" crossorigin></script>
    
    <!-- Babel -->
    <script src="https://unpkg.com/@babel/standalone/babel.min.js"></script>
    
    <!-- Tailwind CSS -->
    <script src="https://cdn.tailwindcss.com"></script>
    
    <!-- Google Fonts -->
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;500;600;700;800&family=Fira+Code:wght@400;500&display=swap" rel="stylesheet">

    <!-- Custom Styles -->
    <style>
        body {
            font-family: 'Inter', sans-serif;
            background-color: #020617; /* Slate 950 */
            color: white;
            overflow-x: hidden;
            margin: 0;
        }

        /* Glassmorphism Classes */
        .glass-panel {
            background: rgba(30, 41, 59, 0.4);
            backdrop-filter: blur(12px);
            -webkit-backdrop-filter: blur(12px);
            border: 1px solid rgba(255, 255, 255, 0.1);
            box-shadow: 0 8px 32px 0 rgba(0, 0, 0, 0.37);
        }
        
        .glass-card {
            background: rgba(255, 255, 255, 0.03);
            backdrop-filter: blur(8px);
            border: 1px solid rgba(255, 255, 255, 0.05);
            transition: all 0.3s cubic-bezier(0.4, 0, 0.2, 1);
        }

        .glass-card:hover {
            background: rgba(255, 255, 255, 0.08);
            border-color: rgba(96, 165, 250, 0.3);
            transform: translateY(-4px);
            box-shadow: 0 20px 40px -10px rgba(0,0,0,0.5);
        }

        /* Code Editor Font */
        .font-mono-code {
            font-family: 'Fira Code', monospace;
        }

        /* Marquee Animation */
        .marquee-wrapper {
            position: relative;
            overflow: hidden;
            mask-image: linear-gradient(to right, transparent, black 20%, black 80%, transparent);
        }
        
        .marquee-content {
            display: flex;
            animation: scroll 40s linear infinite;
            width: max-content;
        }

        .marquee-content:hover {
            animation-play-state: paused;
        }

        @keyframes scroll {
            0% { transform: translateX(0); }
            100% { transform: translateX(-50%); }
        }

        /* Text Gradients */
        .text-gradient {
            background: linear-gradient(135deg, #60a5fa 0%, #a855f7 50%, #ec4899 100%);
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
        }

        /* Animations */
        .animate-enter { animation: enter 0.5s ease-out forwards; }
        .animate-spin-slow { animation: spin 3s linear infinite; }
        
        @keyframes enter {
            from { opacity: 0; transform: translateY(20px); }
            to { opacity: 1; transform: translateY(0); }
        }
        @keyframes spin { from { transform: rotate(0deg); } to { transform: rotate(360deg); } }

        /* Scrollbar */
        ::-webkit-scrollbar { width: 6px; }
        ::-webkit-scrollbar-track { background: #0f172a; }
        ::-webkit-scrollbar-thumb { background: #334155; border-radius: 10px; }
        ::-webkit-scrollbar-thumb:hover { background: #475569; }
    </style>
</head>
<body>
    <div id="root"></div>

    <script type="text/babel" data-presets="react,env">
        const { useState, useEffect, useRef } = React;

        // --- MOCK BACKEND SERVICE ---
        const MockBackend = {
            generateQuestion: (company, role, round) => {
                if (round?.id.includes('tech')) {
                    const codingQuestions = [
                        "Write a function to reverse a Linked List.",
                        "Implement a function to check if a string is a palindrome.",
                        "Find the missing number in an array of 1 to N.",
                        "Design a rate limiter system."
                    ];
                    return codingQuestions[Math.floor(Math.random() * codingQuestions.length)];
                }
                
                if (round?.id === 'hr') return "Where do you see yourself in 5 years?";
                if (round?.id === 'comm') return "Describe a complex idea to a 5-year-old.";
                
                // Default
                const questions = [
                    "Tell me about a challenging project you worked on recently.",
                    "How do you handle disagreements with team members?",
                    `Why do you want to work at ${company?.name || 'our company'}?`,
                ];
                return questions[Math.floor(Math.random() * questions.length)];
            },
            analyzeResponse: async (text) => {
                return new Promise(resolve => setTimeout(resolve, 2000)); 
            }
        };

        // --- ICONS ---
        const Icon = ({ path, size = 24, className = "" }) => (
            <svg width={size} height={size} viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2" strokeLinecap="round" strokeLinejoin="round" className={className}>
                {path}
            </svg>
        );

        const Icons = {
            Mic: <><path d="M12 1a3 3 0 0 0-3 3v8a3 3 0 0 0 6 0V4a3 3 0 0 0-3-3z"/><path d="M19 10v2a7 7 0 0 1-14 0v-2"/><line x1="12" y1="19" x2="12" y2="23"/><line x1="8" y1="23" x2="16" y2="23"/></>,
            MicOff: <><line x1="1" y1="1" x2="23" y2="23"/><path d="M9 9v3a3 3 0 0 0 5.12 2.12M15 9.34V4a3 3 0 0 0-5.94-.6"/></>,
            Video: <><polygon points="23 7 16 12 23 17 23 7"/><rect x="1" y="5" width="15" height="14" rx="2" ry="2"/></>,
            VideoOff: <><path d="M16 16v1a2 2 0 0 1-2 2H3a2 2 0 0 1-2-2V7a2 2 0 0 1 2-2h2m5.66 0H14a2 2 0 0 1 2 2v3.34l1 1L23 7v10"/><line x1="1" y1="1" x2="23" y2="23"/></>,
            PhoneOff: <><path d="M10.68 13.31a16 16 0 0 0 3.41 2.6l1.27-1.27a2 2 0 0 1 2.11-.45 12.84 12.84 0 0 0 2.81.7 2 2 0 0 1 1.72 2v3a2 2 0 0 1-2.18 2 19.79 19.79 0 0 1-8.63-3.07 19.42 19.42 0 0 1-3.33-2.67m-2.67-3.34a19.79 19.79 0 0 1-3.07-8.63A2 2 0 0 1 4.11 2h3a2 2 0 0 1 2 1.72 12.84 12.84 0 0 0 .7 2.81 2 2 0 0 1-.45 2.11L8.09 9.91"/><line x1="1" y1="1" x2="23" y2="23"/></>,
            Upload: <><path d="M21 15v4a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2v-4"/><polyline points="17 8 12 3 7 8"/><line x1="12" y1="3" x2="12" y2="15"/></>,
            Clock: <><circle cx="12" cy="12" r="10"/><polyline points="12 6 12 12 16 14"/></>,
            Check: <polyline points="20 6 9 17 4 12"/>,
            ChevronRight: <polyline points="9 18 15 12 9 6"/>,
            ChevronLeft: <polyline points="15 18 9 12 15 6"/>,
            Sparkles: <><path d="m12 3-1.912 5.813a2 2 0 0 1-1.275 1.275L3 12l5.813 1.912a2 2 0 0 1 1.275 1.275L12 21l1.912-5.813a2 2 0 0 1 1.275-1.275L12 3Z"/><path d="M5 3v4"/><path d="M9 3v4"/><path d="M2 7h4"/><path d="M2 3h4"/></>,
            Briefcase: <><rect x="2" y="7" width="20" height="14" rx="2" ry="2"/><path d="M16 21V5a2 2 0 0 0-2-2h-4a2 2 0 0 0-2 2v16"/></>,
            Code: <><polyline points="16 18 22 12 16 6"/><polyline points="8 6 2 12 8 18"/></>,
            Brain: <><path d="M9.5 2A2.5 2.5 0 0 1 12 4.5v15a2.5 2.5 0 0 1-4.96.44 2.5 2.5 0 0 1-2.96-3.08 3 3 0 0 1-.34-5.58 2.5 2.5 0 0 1 1.32-4.24 2.5 2.5 0 0 1 1.98-3A2.5 2.5 0 0 1 9.5 2Z"/><path d="M14.5 2A2.5 2.5 0 0 0 12 4.5v15a2.5 2.5 0 0 0 4.96.44 2.5 2.5 0 0 0 2.96-3.08 3 3 0 0 0 .34-5.58 2.5 2.5 0 0 0-1.32-4.24 2.5 2.5 0 0 0-1.98-3A2.5 2.5 0 0 0 14.5 2Z"/></>,
            Database: <><ellipse cx="12" cy="5" rx="9" ry="3"/><path d="M21 12c0 1.66-4 3-9 3s-9-1.34-9-3"/><path d="M3 5v14c0 1.66 4 3 9 3s9-1.34 9-3V5"/></>,
            Star: <polygon points="12 2 15.09 8.26 22 9.27 17 14.14 18.18 21.02 12 17.77 5.82 21.02 7 14.14 2 9.27 8.91 8.26 12 2"/>,
            TrendingUp: <><polyline points="23 6 13.5 15.5 8.5 10.5 1 18"/><polyline points="17 6 23 6 23 12"/></>,
            AlertCircle: <><circle cx="12" cy="12" r="10"/><line x1="12" y1="8" x2="12" y2="12"/><line x1="12" y1="16" x2="12.01" y2="16"/></>,
            Loader: <path d="M21 12a9 9 0 1 1-6.219-8.56"/>,
            User: <><path d="M20 21v-2a4 4 0 0 0-4-4H8a4 4 0 0 0-4 4v2"/><circle cx="12" cy="7" r="4"/></>,
            LogOut: <><path d="M9 21H5a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2h4"/><polyline points="16 17 21 12 16 7"/><line x1="21" y1="12" x2="9" y2="12"/></>,
            Play: <polygon points="5 3 19 12 5 21 5 3"/>,
            X: <><line x1="18" y1="6" x2="6" y2="18"/><line x1="6" y1="6" x2="18" y2="18"/></>
        };

        const SimpleIcon = ({ name, size, className }) => (
            <Icon path={Icons[name] || Icons.AlertCircle} size={size} className={className} />
        );

        // --- DATA ---
        const COMPANIES = [
            { name: "Google", color: "text-red-500", bg: "bg-red-500/10" },
            { name: "Microsoft", color: "text-blue-500", bg: "bg-blue-500/10" },
            { name: "Meta", color: "text-blue-600", bg: "bg-blue-600/10" },
            { name: "Amazon", color: "text-yellow-500", bg: "bg-yellow-500/10" },
            { name: "Netflix", color: "text-red-600", bg: "bg-red-600/10" },
            { name: "Apple", color: "text-gray-200", bg: "bg-gray-500/10" },
            { name: "Tesla", color: "text-red-500", bg: "bg-red-500/10" },
            { name: "OpenAI", color: "text-green-500", bg: "bg-green-500/10" },
            { name: "DeepSeek", color: "text-purple-500", bg: "bg-purple-500/10" },
            { name: "Infosys", color: "text-blue-400", bg: "bg-blue-400/10" }
        ];

        const ROLES = [
            { id: 'swe', title: 'Software Engineer', icon: 'Code', desc: 'Algorithms, System Design' },
            { id: 'ml', title: 'Machine Learning', icon: 'Brain', desc: 'Models, Neural Networks' },
            { id: 'ai', title: 'AI Engineer', icon: 'Sparkles', desc: 'LLMs, Agents, RAG' },
            { id: 'data', title: 'Data Analyst', icon: 'Database', desc: 'SQL, Visualization' },
        ];

        const ROUNDS = [
            { id: 'comm', title: 'Communication Round', agent: 'Communication Agent', desc: 'Verbal fluency & clarity', isTech: false },
            { id: 'hr', title: 'HR Round', agent: 'HR Agent', desc: 'Culture fit & background', isTech: false },
            { id: 'behav', title: 'Behavioral Round', agent: 'Behavioral Agent', desc: 'Situational questions', isTech: false },
            { id: 'tech1', title: 'Technical Round 1', agent: 'Technical Agent', desc: 'Core Coding & DSA', isTech: true },
            { id: 'apt', title: 'Aptitude Round', agent: 'Aptitude Agent', desc: 'Logic & Reasoning', isTech: false },
            { id: 'tech2', title: 'Technical Round 2', agent: 'System Design Agent', desc: 'Architecture & Scale', isTech: true },
        ];

        // --- COMPONENTS ---

        const VideoModal = ({ onClose }) => (
            <div className="fixed inset-0 z-50 flex items-center justify-center bg-black/80 backdrop-blur-sm animate-enter" onClick={onClose}>
                <div className="relative w-full max-w-4xl aspect-video bg-black rounded-2xl overflow-hidden shadow-2xl border border-white/10" onClick={e => e.stopPropagation()}>
                    <button onClick={onClose} className="absolute top-4 right-4 z-10 p-2 bg-black/50 rounded-full hover:bg-white/20 text-white transition">
                        <SimpleIcon name="X" size={24} />
                    </button>
                    <iframe 
                        width="100%" 
                        height="100%" 
                        src="https://www.youtube.com/embed/0e3GPea1Tyg?autoplay=1" 
                        title="YouTube video player" 
                        frameBorder="0" 
                        allow="accelerometer; autoplay; clipboard-write; encrypted-media; gyroscope; picture-in-picture" 
                        allowFullScreen>
                    </iframe>
                </div>
            </div>
        );

        const LoginPage = ({ onLogin, onBack }) => {
            const [user, setUser] = useState('');
            const [pass, setPass] = useState('');
            const [error, setError] = useState('');

            const handleSubmit = (e) => {
                e.preventDefault();
                if (user === 'admin' && pass === 'admin') {
                    onLogin({ name: 'Admin User', username: 'admin', avatar: 'https://api.dicebear.com/7.x/avataaars/svg?seed=Felix' });
                } else {
                    setError('Invalid credentials. Hint: admin/admin');
                }
            };

            return (
                <div className="min-h-screen flex items-center justify-center relative p-4">
                    <div className="absolute inset-0 bg-[radial-gradient(ellipse_at_center,_var(--tw-gradient-stops))] from-blue-900/30 via-[#020617] to-[#020617] -z-10"></div>
                    <button onClick={onBack} className="absolute top-6 left-6 text-slate-400 hover:text-white flex items-center gap-2">
                        <SimpleIcon name="ChevronLeft" size={20} /> Back to Home
                    </button>

                    <div className="w-full max-w-md glass-panel p-8 rounded-2xl animate-enter">
                        <div className="text-center mb-8">
                            <h2 className="text-3xl font-bold mb-2">Welcome Back</h2>
                            <p className="text-slate-400">Login to access your profile</p>
                        </div>

                        <form onSubmit={handleSubmit} className="space-y-4">
                            <div>
                                <label className="block text-sm font-medium text-slate-300 mb-1">Username</label>
                                <input 
                                    type="text" 
                                    value={user} 
                                    onChange={e => setUser(e.target.value)}
                                    className="w-full bg-slate-800/50 border border-slate-700 rounded-lg p-3 text-white focus:outline-none focus:border-blue-500 focus:ring-1 focus:ring-blue-500 transition"
                                    placeholder="Enter username"
                                />
                            </div>
                            <div>
                                <label className="block text-sm font-medium text-slate-300 mb-1">Password</label>
                                <input 
                                    type="password" 
                                    value={pass} 
                                    onChange={e => setPass(e.target.value)}
                                    className="w-full bg-slate-800/50 border border-slate-700 rounded-lg p-3 text-white focus:outline-none focus:border-blue-500 focus:ring-1 focus:ring-blue-500 transition"
                                    placeholder="Enter password"
                                />
                            </div>
                            
                            {error && <p className="text-red-400 text-sm text-center">{error}</p>}

                            <button type="submit" className="w-full bg-blue-600 hover:bg-blue-500 text-white font-bold py-3 rounded-lg transition shadow-lg shadow-blue-500/20">
                                Login
                            </button>
                        </form>
                    </div>
                </div>
            );
        };

        const ProfilePage = ({ user, history, onBack }) => {
            return (
                <div className="min-h-screen bg-[#020617] p-4 md:p-8">
                    <div className="max-w-6xl mx-auto">
                        <button onClick={onBack} className="mb-6 text-slate-400 hover:text-white flex items-center gap-2">
                            <SimpleIcon name="ChevronLeft" size={20} /> Back to Dashboard
                        </button>

                        <div className="glass-panel p-8 rounded-2xl flex flex-col md:flex-row items-center gap-8 mb-8">
                            <img src={user.avatar} alt="Profile" className="w-32 h-32 rounded-full border-4 border-blue-500/30 bg-slate-800" />
                            <div className="text-center md:text-left flex-1">
                                <h1 className="text-3xl font-bold mb-2">{user.name}</h1>
                                <p className="text-slate-400">@{user.username}</p>
                                <div className="flex gap-4 mt-4 justify-center md:justify-start">
                                    <div className="bg-slate-800 px-4 py-2 rounded-lg border border-slate-700">
                                        <div className="text-2xl font-bold text-white">{history.length}</div>
                                        <div className="text-xs text-slate-400 uppercase">Interviews</div>
                                    </div>
                                    <div className="bg-slate-800 px-4 py-2 rounded-lg border border-slate-700">
                                        <div className="text-2xl font-bold text-green-400">
                                            {history.length > 0 ? Math.round(history.reduce((a,b) => a + b.score, 0) / history.length) : 0}%
                                        </div>
                                        <div className="text-xs text-slate-400 uppercase">Avg Score</div>
                                    </div>
                                </div>
                            </div>
                        </div>

                        <h2 className="text-2xl font-bold mb-6 flex items-center gap-2">
                            <SimpleIcon name="Briefcase" size={24} className="text-blue-400" /> Interview History
                        </h2>
                        
                        <div className="space-y-4">
                            {history.length === 0 ? (
                                <div className="text-center py-12 text-slate-500 bg-slate-900/50 rounded-xl border border-dashed border-slate-800">
                                    No interviews taken yet. Start your first simulation!
                                </div>
                            ) : (
                                history.map((session, idx) => (
                                    <div key={idx} className="glass-card p-6 rounded-xl flex flex-col md:flex-row gap-6 border border-white/5">
                                        <div className="flex-1">
                                            <div className="flex items-center gap-3 mb-2">
                                                <span className="font-bold text-lg">{session.company}</span>
                                                <span className="text-slate-400">•</span>
                                                <span className="text-slate-300">{session.role}</span>
                                                <span className="text-xs bg-blue-500/20 text-blue-300 px-2 py-0.5 rounded border border-blue-500/30">{session.round}</span>
                                            </div>
                                            <div className="text-sm text-slate-500 mb-4">{session.date}</div>
                                            
                                            <div className="bg-slate-800/50 p-4 rounded-lg border border-slate-700/50">
                                                <h4 className="font-bold text-yellow-400 text-sm mb-2 flex items-center gap-2">
                                                    <SimpleIcon name="TrendingUp" size={16} /> Improvement Plan
                                                </h4>
                                                <p className="text-sm text-slate-300 italic">"{session.improvement}"</p>
                                            </div>
                                        </div>
                                        
                                        <div className="flex flex-col items-center justify-center min-w-[100px] border-l border-white/10 pl-6">
                                            <div className="text-4xl font-bold text-white mb-1">{session.score}</div>
                                            <div className="text-xs text-slate-500 uppercase">Score</div>
                                        </div>
                                    </div>
                                ))
                            )}
                        </div>
                    </div>
                </div>
            );
        };

        const LandingPage = ({ onStart, onLoginClick, user, onProfileClick, onDemoClick }) => {
            return (
                <div className="min-h-screen relative flex flex-col">
                    <div className="absolute top-[-10%] left-[-10%] w-[50vw] h-[50vw] bg-blue-600/20 rounded-full blur-[120px] pointer-events-none"></div>
                    <div className="absolute bottom-[-10%] right-[-10%] w-[50vw] h-[50vw] bg-purple-600/20 rounded-full blur-[120px] pointer-events-none"></div>

                    <nav className="z-10 px-8 py-6 flex justify-between items-center glass-panel mx-4 mt-4 rounded-2xl">
                        <div className="flex items-center gap-2 font-bold text-2xl tracking-tighter">
                            <div className="w-8 h-8 rounded-lg bg-gradient-to-tr from-blue-500 to-purple-600 flex items-center justify-center">
                                <SimpleIcon name="Sparkles" size={20} className="text-white" />
                            </div>
                            Mock<span className="text-blue-400">AI</span>
                        </div>
                        
                        {user ? (
                            <div className="flex items-center gap-6">
                                <a href="#" className="text-slate-300 hover:text-white font-medium transition">Home</a>
                                <a href="#" className="text-slate-300 hover:text-white font-medium transition">Features</a>
                                <button onClick={onProfileClick} className="flex items-center gap-2 pl-6 border-l border-white/10">
                                    <img src={user.avatar} alt="User" className="w-8 h-8 rounded-full border border-blue-500/50" />
                                    <span className="font-medium">{user.name}</span>
                                </button>
                            </div>
                        ) : (
                            <div className="flex gap-4">
                                 <button onClick={onLoginClick} className="px-5 py-2 text-slate-300 hover:text-white font-medium">Login</button>
                                 <button onClick={() => onStart()} className="px-5 py-2 bg-white text-black font-bold rounded-lg hover:bg-slate-200 transition shadow-[0_0_20px_rgba(255,255,255,0.3)]">
                                    Get Started
                                </button>
                            </div>
                        )}
                    </nav>

                    <main className="flex-1 flex flex-col items-center justify-center text-center px-4 relative z-10 mt-12 mb-12">
                        <div className="inline-flex items-center gap-2 px-3 py-1 rounded-full border border-green-500/30 bg-green-500/10 text-green-400 text-xs font-bold mb-6 animate-pulse">
                            <span className="w-2 h-2 rounded-full bg-green-500"></span>
                            New: DeepSeek & OpenAI Agents Added
                        </div>
                        
                        <h1 className="text-5xl md:text-7xl font-bold mb-6 max-w-5xl leading-[1.1] tracking-tight">
                            Master Your Next Interview with <br className="hidden md:block"/>
                            <span className="text-gradient">AI Simulation</span>
                        </h1>
                        
                        <p className="text-lg md:text-xl text-slate-400 max-w-2xl mb-10 leading-relaxed">
                            Practice real company-specific interviews with intelligent AI Agents. Get real-time feedback on technical skills, voice modulation, and body language.
                        </p>

                        <div className="flex flex-col sm:flex-row gap-4 w-full justify-center mb-16">
                            <button onClick={() => onStart()} className="group px-8 py-4 bg-gradient-to-r from-blue-600 to-purple-600 rounded-xl font-bold text-lg hover:scale-105 transition shadow-lg shadow-purple-500/25 flex items-center justify-center gap-2">
                                Start Free Simulation
                                <SimpleIcon name="ChevronRight" size={20} className="group-hover:translate-x-1 transition" />
                            </button>
                            <button onClick={onDemoClick} className="px-8 py-4 glass-panel rounded-xl font-bold text-lg hover:bg-white/5 transition flex items-center justify-center gap-2">
                                <div className="w-6 h-6 rounded-full border-2 border-white flex items-center justify-center">
                                    <SimpleIcon name="Play" size={10} className="ml-0.5 fill-white" />
                                </div>
                                View Demo
                            </button>
                        </div>
                    </main>

                    <div className="w-full py-8 border-y border-white/5 bg-black/20 backdrop-blur-sm mb-12">
                        <div className="marquee-wrapper">
                            <div className="marquee-content gap-16 px-8">
                                {[...COMPANIES, ...COMPANIES, ...COMPANIES].map((company, i) => (
                                    <div key={i} className="flex items-center gap-3 opacity-50 grayscale hover:grayscale-0 hover:opacity-100 transition duration-300">
                                        <div className={`w-10 h-10 rounded-lg ${company.bg} flex items-center justify-center font-bold text-xl ${company.color}`}>
                                            {company.name[0]}
                                        </div>
                                        <span className="text-xl font-bold text-slate-300">{company.name}</span>
                                    </div>
                                ))}
                            </div>
                        </div>
                    </div>

                    <div className="max-w-6xl mx-auto px-4 pb-20 w-full animate-enter">
                        <div className="text-center mb-10">
                            <h2 className="text-3xl font-bold mb-4">Select a Company to Interview</h2>
                            <p className="text-slate-400">Choose your target and start practicing immediately.</p>
                        </div>
                        <div className="grid grid-cols-2 md:grid-cols-4 lg:grid-cols-5 gap-4">
                            {COMPANIES.map(c => (
                                <button 
                                    key={c.name}
                                    onClick={() => onStart(c)}
                                    className="p-4 rounded-xl glass-card flex flex-col items-center gap-3 group border border-white/5 hover:border-blue-500/50 transition"
                                >
                                    <div className={`w-14 h-14 rounded-full ${c.bg} flex items-center justify-center text-2xl font-bold ${c.color} group-hover:scale-110 transition duration-300 shadow-lg`}>
                                        {c.name[0]}
                                    </div>
                                    <span className="font-semibold group-hover:text-blue-400 transition">{c.name}</span>
                                </button>
                            ))}
                        </div>
                    </div>

                    <footer className="w-full py-6 flex justify-center gap-6 text-slate-500 text-sm border-t border-white/5 bg-black/20">
                        <span>© 2025 MockAI Platform</span>
                        <a href="#" className="hover:text-white">Privacy</a>
                        <a href="#" className="hover:text-white">Terms</a>
                    </footer>
                </div>
            );
        };

        const SetupWizard = ({ initialCompany, onComplete, onBack }) => {
            const [step, setStep] = useState(initialCompany ? 2 : 1);
            const [data, setData] = useState({ company: initialCompany || null, role: null, round: null, resume: null, duration: 5 });
            const [isDragging, setIsDragging] = useState(false);
            const [isProcessing, setIsProcessing] = useState(false);

            const steps = [
                { num: 1, label: "Company" },
                { num: 2, label: "Role" },
                { num: 3, label: "Round" },
                { num: 4, label: "Resume" },
                { num: 5, label: "Details" }
            ];

            const next = () => {
                if (step === 4) {
                    setIsProcessing(true);
                    setTimeout(() => {
                        setIsProcessing(false);
                        setStep(s => Math.min(s + 1, 5));
                    }, 1500);
                } else {
                    setStep(s => Math.min(s + 1, 5));
                }
            };
            const prev = () => setStep(s => Math.max(s - 1, 1));

            const StepCompany = () => (
                <div className="animate-enter">
                    <h2 className="text-3xl font-bold mb-6 text-center">Target Company</h2>
                    <div className="grid grid-cols-2 md:grid-cols-5 gap-4">
                        {COMPANIES.map(c => (
                            <button 
                                key={c.name}
                                onClick={() => { setData({...data, company: c}); setStep(2); }}
                                className={`p-4 rounded-xl border transition flex flex-col items-center gap-3 group
                                    ${data.company?.name === c.name 
                                        ? 'bg-blue-600/20 border-blue-500 ring-1 ring-blue-500' 
                                        : 'glass-card border-transparent hover:border-slate-500'}`}
                            >
                                <div className={`w-12 h-12 rounded-full ${c.bg} flex items-center justify-center text-xl font-bold ${c.color} group-hover:scale-110 transition`}>
                                    {c.name[0]}
                                </div>
                                <span className="font-semibold">{c.name}</span>
                            </button>
                        ))}
                    </div>
                </div>
            );

            const StepRole = () => (
                <div className="animate-enter">
                    <h2 className="text-3xl font-bold mb-6 text-center">Select Role</h2>
                    <div className="grid grid-cols-1 md:grid-cols-2 gap-4">
                        {ROLES.map(r => (
                            <button 
                                key={r.id}
                                onClick={() => { setData({...data, role: r}); setStep(3); }}
                                className={`p-6 rounded-xl border text-left flex items-start gap-4 transition group
                                    ${data.role?.id === r.id 
                                        ? 'bg-blue-600/20 border-blue-500' 
                                        : 'glass-card border-transparent hover:border-slate-500'}`}
                            >
                                <div className={`p-3 rounded-lg bg-slate-800 text-blue-400 group-hover:bg-blue-500 group-hover:text-white transition`}>
                                    <SimpleIcon name={r.icon} size={24} />
                                </div>
                                <div>
                                    <div className="font-bold text-lg mb-1">{r.title}</div>
                                    <div className="text-sm text-slate-400">{r.desc}</div>
                                </div>
                            </button>
                        ))}
                    </div>
                </div>
            );

            // NEW: Round Selection Step
            const StepRound = () => (
                <div className="animate-enter">
                    <h2 className="text-3xl font-bold mb-6 text-center">Select Interview Round</h2>
                    <div className="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-4">
                        {ROUNDS.map(r => (
                            <button 
                                key={r.id}
                                onClick={() => { 
                                    // If technical round, set duration to 15m default
                                    setData({...data, round: r, duration: r.isTech ? 15 : 5}); 
                                    setStep(4); 
                                }}
                                className={`p-6 rounded-xl border text-left flex flex-col gap-2 transition group
                                    ${data.round?.id === r.id 
                                        ? 'bg-blue-600/20 border-blue-500 ring-1 ring-blue-500' 
                                        : 'glass-card border-transparent hover:border-slate-500'}`}
                            >
                                <div className="flex justify-between items-start">
                                    <h3 className="font-bold text-lg">{r.title}</h3>
                                    {r.isTech && <span className="text-[10px] bg-purple-500/20 text-purple-300 px-2 py-1 rounded border border-purple-500/30">CODING</span>}
                                </div>
                                <p className="text-sm text-slate-400">{r.desc}</p>
                                <div className="mt-2 text-xs font-mono text-blue-300 bg-blue-900/20 inline-block px-2 py-1 rounded self-start">
                                    Agent: {r.agent}
                                </div>
                            </button>
                        ))}
                    </div>
                </div>
            );

            const StepResume = () => (
                <div className="animate-enter text-center">
                    <h2 className="text-3xl font-bold mb-2">Upload Resume</h2>
                    <p className="text-slate-400 mb-8">The {data.round.agent} will analyze your background.</p>
                    
                    {isProcessing ? (
                        <div className="h-64 flex flex-col items-center justify-center gap-4">
                            <SimpleIcon name="Loader" size={48} className="text-blue-500 animate-spin-slow" />
                            <div className="text-lg font-bold animate-pulse">Scanning Resume...</div>
                            <div className="text-sm text-slate-400">Extracting keywords for {data.round.title}</div>
                        </div>
                    ) : (
                        <div 
                            className={`max-w-xl mx-auto h-64 border-2 border-dashed rounded-2xl flex flex-col items-center justify-center gap-4 transition cursor-pointer relative overflow-hidden
                                ${isDragging ? 'border-blue-500 bg-blue-500/10' : 'border-slate-700 bg-slate-900/50 hover:border-slate-500'}`}
                            onDragOver={(e) => { e.preventDefault(); setIsDragging(true); }}
                            onDragLeave={() => setIsDragging(false)}
                            onDrop={(e) => {
                                e.preventDefault();
                                setIsDragging(false);
                                if(e.dataTransfer.files[0]) {
                                    setData({...data, resume: e.dataTransfer.files[0].name});
                                    setTimeout(next, 800);
                                }
                            }}
                        >
                            <input 
                                type="file" 
                                className="absolute inset-0 opacity-0 cursor-pointer"
                                onChange={(e) => {
                                    if(e.target.files[0]) {
                                        setData({...data, resume: e.target.files[0].name});
                                        setTimeout(next, 800);
                                    }
                                }} 
                            />
                            
                            {data.resume ? (
                                <div className="flex flex-col items-center text-green-400">
                                    <div className="w-16 h-16 bg-green-500/20 rounded-full flex items-center justify-center mb-2">
                                        <SimpleIcon name="Check" size={32} />
                                    </div>
                                    <span className="font-bold text-lg">{data.resume}</span>
                                    <span className="text-sm">Uploaded Successfully</span>
                                </div>
                            ) : (
                                <>
                                    <div className="w-16 h-16 bg-slate-800 rounded-full flex items-center justify-center text-blue-400">
                                        <SimpleIcon name="Upload" size={32} />
                                    </div>
                                    <div>
                                        <p className="font-bold text-lg">Click or Drag Resume Here</p>
                                        <p className="text-sm text-slate-500">PDF, DOCX up to 10MB</p>
                                    </div>
                                </>
                            )}
                        </div>
                    )}
                </div>
            );

            const StepTime = () => (
                <div className="animate-enter text-center">
                    <h2 className="text-3xl font-bold mb-6">Confirm Interview Details</h2>
                    
                    <div className="max-w-md mx-auto bg-slate-800/50 p-6 rounded-xl border border-slate-700 mb-8 text-left">
                        <div className="flex justify-between items-center mb-4 pb-4 border-b border-slate-700">
                            <span className="text-slate-400">Agent</span>
                            <span className="font-bold text-blue-400">{data.round.agent}</span>
                        </div>
                        <div className="flex justify-between items-center mb-4">
                            <span className="text-slate-400">Round Type</span>
                            <span className="font-bold">{data.round.title}</span>
                        </div>
                        <div className="flex justify-between items-center">
                            <span className="text-slate-400">Duration</span>
                            <div className="flex items-center gap-2">
                                <SimpleIcon name="Clock" size={16} className="text-slate-400" />
                                <span className="font-bold text-xl">{data.duration} mins</span>
                            </div>
                        </div>
                        {data.round.isTech && (
                            <div className="mt-4 p-3 bg-yellow-500/10 border border-yellow-500/20 rounded text-sm text-yellow-200 flex gap-2">
                                <SimpleIcon name="AlertCircle" size={16} className="shrink-0 mt-0.5" />
                                <div>
                                    <strong>Technical Round:</strong> You will have a live coding environment. Submissions have a 3-min limit per question.
                                </div>
                            </div>
                        )}
                    </div>
                    
                    <button 
                        onClick={() => onComplete(data)}
                        className="px-12 py-4 bg-green-600 hover:bg-green-500 text-white rounded-xl font-bold text-lg shadow-xl shadow-green-500/20 transition hover:scale-105 flex items-center gap-2 mx-auto"
                    >
                        Enter Interview Room
                        <SimpleIcon name="ChevronRight" size={20} />
                    </button>
                </div>
            );

            return (
                <div className="min-h-screen flex flex-col items-center justify-center p-6 relative overflow-hidden">
                    <div className="absolute inset-0 bg-[radial-gradient(ellipse_at_top,_var(--tw-gradient-stops))] from-slate-900 via-[#020617] to-[#020617]"></div>
                    
                    <div className="w-full max-w-4xl glass-panel p-8 md:p-12 rounded-3xl relative z-10 min-h-[600px] flex flex-col">
                        <div className="flex justify-between items-center mb-12 relative">
                            <div className="absolute left-0 top-1/2 w-full h-1 bg-slate-800 -z-10 rounded-full"></div>
                            <div className="absolute left-0 top-1/2 h-1 bg-blue-500 -z-10 rounded-full transition-all duration-500" style={{ width: `${((step-1)/4)*100}%` }}></div>
                            
                            {steps.map((s, idx) => (
                                <div key={s.num} className="flex flex-col items-center gap-2 bg-[#020617] px-2 z-10">
                                    <div className={`w-10 h-10 rounded-full flex items-center justify-center font-bold border-2 transition-all duration-300
                                        ${step >= s.num ? 'bg-blue-600 border-blue-600 text-white' : 'bg-slate-800 border-slate-700 text-slate-500'}`}>
                                        {step > s.num ? <SimpleIcon name="Check" size={18} /> : s.num}
                                    </div>
                                    <span className={`text-xs font-semibold uppercase tracking-wider hidden md:block ${step >= s.num ? 'text-blue-400' : 'text-slate-600'}`}>{s.label}</span>
                                </div>
                            ))}
                        </div>

                        <div className="flex-1">
                            {step === 1 && <StepCompany />}
                            {step === 2 && <StepRole />}
                            {step === 3 && <StepRound />}
                            {step === 4 && <StepResume />}
                            {step === 5 && <StepTime />}
                        </div>

                        <div className="mt-8 flex justify-between border-t border-slate-800 pt-6">
                            <button onClick={prev} disabled={step === 1 && !initialCompany} className="text-slate-400 hover:text-white disabled:opacity-30 disabled:cursor-not-allowed flex items-center gap-1 font-medium">
                                <SimpleIcon name="ChevronLeft" size={16} /> Back
                            </button>
                            <button onClick={onBack} className="text-sm text-red-400 hover:text-red-300">
                                Cancel Setup
                            </button>
                        </div>
                    </div>
                </div>
            );
        };

        // --- Realistic Human Avatar Canvas ---
        const AvatarCanvas = ({ isSpeaking }) => {
            const canvasRef = useRef(null);

            useEffect(() => {
                const canvas = canvasRef.current;
                const ctx = canvas.getContext('2d');
                let animationFrameId;
                let t = 0;

                const draw = () => {
                    t += 0.05; // Slower, more natural time
                    const w = canvas.width;
                    const h = canvas.height;
                    const cx = w / 2;
                    const cy = h / 2;

                    // Breathing motion (vertical shift)
                    const breathY = Math.sin(t * 0.5) * 2; 
                    // Head sway
                    const swayX = Math.sin(t * 0.2) * 1.5;

                    ctx.clearRect(0, 0, w, h);

                    // 1. Background Office Blur (Abstract)
                    const bgGrad = ctx.createLinearGradient(0, 0, 0, h);
                    bgGrad.addColorStop(0, "#1e293b");
                    bgGrad.addColorStop(1, "#0f172a");
                    ctx.fillStyle = bgGrad;
                    // ctx.fillRect(0, 0, w, h); // Optional bg fill

                    // --- BODY (Shoulders) ---
                    ctx.save();
                    ctx.translate(0, breathY); 
                    
                    // Suit
                    ctx.fillStyle = "#2c3e50"; // Professional Blue/Grey
                    ctx.beginPath();
                    ctx.ellipse(cx, cy + 160, 130, 70, 0, 0, Math.PI * 2);
                    ctx.fill();

                    // Shirt Collar
                    ctx.fillStyle = "#e2e8f0";
                    ctx.beginPath();
                    ctx.moveTo(cx - 35, cy + 110);
                    ctx.lineTo(cx + 35, cy + 110);
                    ctx.lineTo(cx, cy + 150);
                    ctx.fill();
                    
                    // Neck
                    ctx.fillStyle = "#dba889"; // Skin tone
                    ctx.fillRect(cx - 28, cy + 70, 56, 50);
                    // Neck Shadow
                    ctx.fillStyle = "rgba(0,0,0,0.1)";
                    ctx.fillRect(cx - 28, cy + 70, 56, 10);

                    ctx.restore();

                    // --- HEAD ---
                    ctx.save();
                    ctx.translate(swayX, breathY * 0.5); // Head moves slightly less than body

                    // Face Base
                    ctx.fillStyle = "#eac09e"; // Base Skin
                    ctx.beginPath();
                    ctx.ellipse(cx, cy + 10, 80, 100, 0, 0, Math.PI * 2); // Oval Face
                    ctx.fill();

                    // Beard/Shadow (Subtle)
                    ctx.fillStyle = "rgba(50, 40, 30, 0.05)";
                    ctx.beginPath();
                    ctx.arc(cx, cy + 40, 75, 0.2 * Math.PI, 0.8 * Math.PI);
                    ctx.fill();

                    // Hair (Short, dark)
                    ctx.fillStyle = "#1a1a1a";
                    ctx.beginPath();
                    ctx.arc(cx, cy - 10, 82, Math.PI, 0); // Top
                    ctx.lineTo(cx + 80, cy + 20);
                    ctx.quadraticCurveTo(cx + 82, cy - 30, cx, cy - 30); // Hairline
                    ctx.quadraticCurveTo(cx - 82, cy - 30, cx - 80, cy + 20);
                    ctx.fill();

                    // Glasses (Tech CEO)
                    ctx.strokeStyle = "#333";
                    ctx.lineWidth = 3;
                    // Left
                    ctx.strokeRect(cx - 65, cy - 15, 50, 30);
                    // Right
                    ctx.strokeRect(cx + 15, cy - 15, 50, 30);
                    // Bridge
                    ctx.beginPath(); 
                    ctx.moveTo(cx - 15, cy); 
                    ctx.lineTo(cx + 15, cy); 
                    ctx.stroke();

                    // Eyes (Natural Blinking & Darting)
                    // Darting logic
                    let eyeX = 0;
                    if (Math.sin(t * 0.1) > 0.9) eyeX = 2;
                    else if (Math.sin(t * 0.1) < -0.9) eyeX = -2;

                    // Blinking logic
                    const blink = Math.sin(t * 0.8) > 0.98 ? 0.1 : 1; // Occasional blink

                    ctx.fillStyle = "#fff"; // Sclera
                    ctx.beginPath(); ctx.ellipse(cx - 40, cy, 12, 8 * blink, 0, 0, Math.PI * 2); ctx.fill();
                    ctx.beginPath(); ctx.ellipse(cx + 40, cy, 12, 8 * blink, 0, 0, Math.PI * 2); ctx.fill();

                    ctx.fillStyle = "#2a1a10"; // Iris/Pupil
                    ctx.beginPath(); ctx.arc(cx - 40 + eyeX, cy, 5 * blink, 0, Math.PI * 2); ctx.fill();
                    ctx.beginPath(); ctx.arc(cx + 40 + eyeX, cy, 5 * blink, 0, Math.PI * 2); ctx.fill();

                    // Nose
                    ctx.strokeStyle = "#d1a079";
                    ctx.lineWidth = 2;
                    ctx.beginPath();
                    ctx.moveTo(cx, cy + 10);
                    ctx.lineTo(cx - 5, cy + 35);
                    ctx.lineTo(cx + 5, cy + 35);
                    ctx.stroke();

                    // Mouth (Lip Sync)
                    ctx.fillStyle = "#c58c6e"; // Lip Color
                    let mouthH = 2;
                    let mouthW = 25;
                    if (isSpeaking) {
                        // Complex movement for speech
                        mouthH = 4 + Math.abs(Math.sin(t * 1.5)) * 10 + Math.sin(t * 3)*2;
                        mouthW = 25 + Math.sin(t * 2) * 5;
                    }

                    ctx.beginPath();
                    ctx.ellipse(cx, cy + 60, mouthW, mouthH, 0, 0, Math.PI * 2);
                    ctx.fill();
                    
                    // Teeth (if speaking loud)
                    if(mouthH > 8) {
                        ctx.fillStyle = "#eee";
                        ctx.fillRect(cx - 10, cy + 55, 20, 4);
                    }

                    ctx.restore();

                    animationFrameId = requestAnimationFrame(draw);
                };

                draw();
                return () => cancelAnimationFrame(animationFrameId);
            }, [isSpeaking]);

            return <canvas ref={canvasRef} width={400} height={400} className="w-full h-full object-contain drop-shadow-2xl" />;
        };

        // --- InterviewRoom (Real-time Logic) ---
        const InterviewRoom = ({ config, onEnd }) => {
            const [timeLeft, setTimeLeft] = useState(config.duration * 60);
            const [taskTimeLeft, setTaskTimeLeft] = useState(3 * 60); // 3 min for task
            const [micOn, setMicOn] = useState(true);
            const [videoOn, setVideoOn] = useState(true);
            const [isSpeaking, setIsSpeaking] = useState(false);
            const [aiStatus, setAiStatus] = useState("speaking"); 
            const [currentQuestion, setCurrentQuestion] = useState("Initializing...");
            const [transcript, setTranscript] = useState([]);
            const [code, setCode] = useState("// Write your solution here...\nfunction solution() {\n  \n}");
            
            const videoRef = useRef(null);

            // Global Timer
            useEffect(() => {
                const timer = setInterval(() => {
                    setTimeLeft(p => {
                        if(p <= 0) { clearInterval(timer); onEnd(); return 0; }
                        return p - 1;
                    });
                }, 1000);
                return () => clearInterval(timer);
            }, []);

            // Task Timer (Only for tech rounds)
            useEffect(() => {
                let timer;
                if (config.round.isTech && aiStatus === 'listening') {
                    timer = setInterval(() => {
                        setTaskTimeLeft(p => Math.max(0, p - 1));
                    }, 1000);
                }
                return () => clearInterval(timer);
            }, [config.round.isTech, aiStatus]);

            useEffect(() => {
                if(videoOn && videoRef.current) {
                    navigator.mediaDevices.getUserMedia({ video: true })
                        .then(stream => { videoRef.current.srcObject = stream; })
                        .catch(err => console.log("Camera mock mode"));
                }
            }, [videoOn]);

            useEffect(() => {
                // Initial startup
                const q = MockBackend.generateQuestion(config.company, config.role, config.round);
                setCurrentQuestion(q);
                setTimeout(() => setAiStatus("listening"), 4000); 
            }, []);

            const formatTime = (s) => {
                const min = Math.floor(s / 60);
                const sec = s % 60;
                return `${min}:${sec < 10 ? '0'+sec : sec}`;
            };

            const handleUserAction = async () => {
                if (aiStatus === 'listening' && !isSpeaking) {
                    setIsSpeaking(true);
                } else if (isSpeaking) {
                    setIsSpeaking(false);
                    setAiStatus("thinking");
                    
                    const userResponse = config.round.isTech ? `[Code Submitted]\n${code}` : "Candidate verbal answer...";
                    setTranscript(prev => [...prev, { sender: "You", text: userResponse }]);
                    
                    await MockBackend.analyzeResponse("dummy text");
                    
                    const nextQ = MockBackend.generateQuestion(config.company, config.role, config.round);
                    setCurrentQuestion(nextQ);
                    setAiStatus("speaking");
                    setTranscript(prev => [...prev, { sender: config.round.agent, text: nextQ }]);
                    
                    // Reset task timer for next question
                    setTaskTimeLeft(3 * 60);
                    
                    setTimeout(() => setAiStatus("listening"), 4000);
                }
            };

            return (
                <div className="h-screen flex flex-col bg-[#0f1115] relative overflow-hidden">
                    <header className="h-16 px-6 border-b border-white/10 flex justify-between items-center bg-slate-900/50 backdrop-blur-md z-20">
                        <div className="flex items-center gap-4">
                            <div className={`w-10 h-10 rounded ${config.company.bg} flex items-center justify-center font-bold text-xl ${config.company.color}`}>
                                {config.company.name[0]}
                            </div>
                            <div>
                                <h1 className="font-bold text-white">{config.company.name} Interview</h1>
                                <div className="flex items-center gap-2 text-xs text-slate-400">
                                    <span>{config.role.title}</span>
                                    <span>•</span>
                                    <span className="text-blue-400 font-bold">{config.round.title}</span>
                                </div>
                            </div>
                        </div>
                        <div className="flex gap-4">
                            {config.round.isTech && (
                                <div className={`px-4 py-1 rounded-full border ${taskTimeLeft < 30 ? 'border-red-500 bg-red-500/20 text-red-400 animate-pulse' : 'border-yellow-500/50 bg-yellow-500/10 text-yellow-200'} font-mono font-bold flex items-center gap-2`}>
                                    <SimpleIcon name="Clock" size={16} />
                                    Task: {formatTime(taskTimeLeft)}
                                </div>
                            )}
                            <div className={`px-4 py-1 rounded-full border border-slate-600 bg-slate-800 text-slate-300 font-mono font-bold`}>
                                Total: {formatTime(timeLeft)}
                            </div>
                        </div>
                    </header>

                    <main className="flex-1 p-4 grid grid-cols-1 md:grid-cols-2 gap-4 relative h-[calc(100vh-5rem)]">
                        
                        {/* Left Side: AI Agent */}
                        <div className="relative glass-panel rounded-2xl flex flex-col items-center justify-center bg-gradient-to-b from-slate-900 to-slate-950 overflow-hidden">
                            <div className="absolute top-4 left-4 bg-black/40 px-3 py-1 rounded-full text-xs font-bold text-blue-400 border border-blue-500/20 backdrop-blur-md z-10 flex items-center gap-2">
                                <div className="w-2 h-2 bg-green-500 rounded-full animate-pulse"></div>
                                {config.round.agent}
                            </div>
                            
                            <div className="w-[90%] max-w-[500px] aspect-square -mt-10">
                                <AvatarCanvas isSpeaking={aiStatus === 'speaking'} />
                            </div>

                            <div className="absolute bottom-8 w-[90%] glass-card p-4 rounded-xl border-l-4 border-blue-500 animate-enter">
                                <p className="text-slate-400 text-xs uppercase font-bold mb-1">Current Question</p>
                                <p className="text-white text-lg font-medium leading-snug">"{currentQuestion}"</p>
                                {aiStatus === 'thinking' && (
                                    <div className="mt-2 flex items-center gap-2 text-purple-400 text-xs font-bold">
                                        <SimpleIcon name="Loader" size={14} className="animate-spin" />
                                        Processing Answer...
                                    </div>
                                )}
                            </div>
                        </div>

                        {/* Right Side: User / Code Editor */}
                        <div className="flex flex-col gap-4 h-full">
                            {config.round.isTech ? (
                                // Technical Round View: Code Editor + Mini Camera
                                <div className="flex-1 glass-panel rounded-2xl p-4 flex flex-col relative">
                                    <div className="flex justify-between items-center mb-2">
                                        <span className="text-xs font-bold text-slate-400 uppercase flex items-center gap-2">
                                            <SimpleIcon name="Code" size={14} /> Live Code Editor
                                        </span>
                                        <span className="text-[10px] text-slate-500">JavaScript</span>
                                    </div>
                                    <textarea 
                                        className="flex-1 bg-[#0d1117] text-green-400 font-mono-code p-4 rounded-lg resize-none focus:outline-none focus:ring-1 focus:ring-green-500/50 text-sm leading-relaxed"
                                        value={code}
                                        onChange={(e) => setCode(e.target.value)}
                                        spellCheck="false"
                                    />
                                    {/* User Mini Cam */}
                                    <div className="absolute bottom-4 right-4 w-32 h-24 bg-black rounded-lg overflow-hidden border border-white/20 shadow-2xl">
                                        {videoOn ? <video ref={videoRef} autoPlay muted className="w-full h-full object-cover transform scale-x-[-1]" /> : <div className="w-full h-full flex items-center justify-center text-slate-600"><SimpleIcon name="VideoOff" size={20} /></div>}
                                    </div>
                                </div>
                            ) : (
                                // Normal Round View: Full Camera
                                <div className="flex-1 relative glass-panel rounded-2xl bg-black overflow-hidden flex items-center justify-center group">
                                    {videoOn ? <video ref={videoRef} autoPlay muted className="w-full h-full object-cover transform scale-x-[-1]" /> : <div className="flex flex-col items-center text-slate-600"><div className="w-24 h-24 rounded-full bg-slate-800 flex items-center justify-center mb-4"><SimpleIcon name="VideoOff" size={40} /></div><p>Camera Off</p></div>}
                                    <div className="absolute bottom-4 left-4 text-white font-medium bg-black/50 px-2 py-1 rounded backdrop-blur-sm">You</div>
                                </div>
                            )}

                            {/* Controls */}
                            <div className="h-20 bg-slate-900/80 backdrop-blur-lg border border-white/10 rounded-2xl flex justify-between items-center px-6">
                                <div className="flex gap-2">
                                    <button onClick={() => setMicOn(!micOn)} className={`p-3 rounded-full transition ${micOn ? 'bg-slate-800 hover:bg-slate-700 text-white' : 'bg-red-500 hover:bg-red-600 text-white'}`}>{micOn ? <SimpleIcon name="Mic" size={20} /> : <SimpleIcon name="MicOff" size={20} />}</button>
                                    <button onClick={() => setVideoOn(!videoOn)} className={`p-3 rounded-full transition ${videoOn ? 'bg-slate-800 hover:bg-slate-700 text-white' : 'bg-red-500 hover:bg-red-600 text-white'}`}>{videoOn ? <SimpleIcon name="Video" size={20} /> : <SimpleIcon name="VideoOff" size={20} />}</button>
                                </div>

                                <button 
                                    onClick={handleUserAction} 
                                    disabled={aiStatus === 'thinking' || aiStatus === 'speaking'} 
                                    className={`h-12 px-8 rounded-xl font-bold transition flex items-center gap-2 shadow-lg ${isSpeaking ? 'bg-green-600 hover:bg-green-500 text-white animate-pulse' : aiStatus === 'speaking' || aiStatus === 'thinking' ? 'bg-slate-800 text-slate-500 cursor-not-allowed' : 'bg-blue-600 hover:bg-blue-500 text-white'}`}
                                >
                                    {isSpeaking ? (config.round.isTech ? "Submit Solution" : "Finish Answer") : "Start Answer"}
                                </button>

                                <button onClick={onEnd} className="p-3 rounded-full bg-red-600 hover:bg-red-700 text-white"><SimpleIcon name="PhoneOff" size={20} /></button>
                            </div>
                        </div>
                    </main>
                </div>
            );
        };

        // --- ResultsPage (Reusable) ---
        const ResultsPage = ({ config, onRestart }) => {
            return (
                <div className="min-h-screen bg-[#020617] flex items-center justify-center p-4">
                    <div className="w-full max-w-6xl h-[90vh] glass-panel rounded-3xl overflow-hidden flex flex-col md:flex-row shadow-2xl">
                        <div className="w-full md:w-1/3 bg-slate-900/80 p-8 flex flex-col border-r border-white/5 relative overflow-hidden">
                            <div className="absolute top-0 left-0 w-full h-2 bg-gradient-to-r from-blue-500 via-purple-500 to-pink-500"></div>
                            <h2 className="text-2xl font-bold mb-8">Performance Summary</h2>
                            <div className="flex-1 flex flex-col items-center justify-center">
                                <div className="relative w-48 h-48 mb-6">
                                    <svg className="w-full h-full transform -rotate-90">
                                        <circle cx="96" cy="96" r="88" className="text-slate-800 stroke-current" strokeWidth="12" fill="none"/>
                                        <circle cx="96" cy="96" r="88" className="text-blue-500 stroke-current" strokeWidth="12" fill="none" strokeDasharray="552" strokeDashoffset="80" strokeLinecap="round"/>
                                    </svg>
                                    <div className="absolute inset-0 flex flex-col items-center justify-center"><span className="text-5xl font-bold text-white">85</span><span className="text-sm text-slate-400 uppercase tracking-widest mt-1">Score</span></div>
                                </div>
                                <div className="text-center"><h3 className="text-xl font-bold text-white mb-2">Great Job!</h3><p className="text-slate-400 text-sm">You performed better than 72% of candidates for {config.role.title}.</p></div>
                            </div>
                            <button onClick={onRestart} className="w-full py-3 bg-white text-slate-900 font-bold rounded-xl hover:bg-slate-200 transition">Start New Session</button>
                        </div>
                        <div className="flex-1 bg-slate-900/40 p-8 md:p-12 overflow-y-auto">
                            <h2 className="text-2xl font-bold mb-6 flex items-center gap-3"><div className="p-2 bg-purple-500/20 rounded-lg text-purple-400"><SimpleIcon name="Briefcase" size={24} /></div>Improvement Plan</h2>
                            <div className="grid grid-cols-1 md:grid-cols-2 gap-6 mb-8">
                                <div className="glass-card p-6 rounded-xl border-l-4 border-green-500 bg-green-500/5">
                                    <h3 className="font-bold text-green-400 mb-4 flex items-center gap-2"><SimpleIcon name="Check" size={18} /> Strengths</h3>
                                    <ul className="space-y-3 text-sm text-slate-300">
                                        <li className="flex gap-2"><span className="text-green-500">•</span> Strong understanding of {config.round.title}.</li>
                                        <li className="flex gap-2"><span className="text-green-500">•</span> Clear communication using the STAR method.</li>
                                    </ul>
                                </div>
                                <div className="glass-card p-6 rounded-xl border-l-4 border-yellow-500 bg-yellow-500/5">
                                    <h3 className="font-bold text-yellow-400 mb-4 flex items-center gap-2"><SimpleIcon name="TrendingUp" size={18} /> Areas to Improve</h3>
                                    <ul className="space-y-3 text-sm text-slate-300">
                                        <li className="flex gap-2"><span className="text-yellow-500">•</span> Deepen knowledge on core concepts.</li>
                                        <li className="flex gap-2"><span className="text-yellow-500">•</span> Reduce use of filler words ("um", "uh").</li>
                                    </ul>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            );
        };

        // --- ROOT APP ---
        const App = () => {
            const [view, setView] = useState('landing');
            const [user, setUser] = useState(null); // Auth state
            const [config, setConfig] = useState(null);
            const [showDemo, setShowDemo] = useState(false);
            
            const [history, setHistory] = useState([
                { id: 1, company: 'Google', role: 'Software Engineer', round: 'Tech Round 1', date: 'Oct 24, 2023', score: 85, improvement: 'Focus on edge cases.' },
            ]);

            const handleLogin = (userData) => {
                setUser(userData);
                setView('landing');
            };

            const handleFinishInterview = (resultConfig) => {
                const newEntry = {
                    id: history.length + 1,
                    company: resultConfig.company.name,
                    role: resultConfig.role.title,
                    round: resultConfig.round.title,
                    date: new Date().toLocaleDateString('en-US', { month: 'short', day: 'numeric', year: 'numeric' }),
                    score: Math.floor(Math.random() * (95 - 70) + 70),
                    improvement: 'Work on conciseness.'
                };
                setHistory([newEntry, ...history]);
                setView('results');
            };

            return (
                <div className="text-white">
                    {showDemo && <VideoModal onClose={() => setShowDemo(false)} />}

                    {view === 'landing' && (
                        <LandingPage 
                            user={user}
                            onStart={(company) => {
                                setConfig(company ? { company } : null);
                                setView('setup');
                            }}
                            onLoginClick={() => setView('login')}
                            onProfileClick={() => setView('profile')}
                            onDemoClick={() => setShowDemo(true)}
                        />
                    )}

                    {view === 'login' && (
                        <LoginPage 
                            onLogin={handleLogin} 
                            onBack={() => setView('landing')} 
                        />
                    )}

                    {view === 'profile' && (
                        <ProfilePage 
                            user={user} 
                            history={history}
                            onBack={() => setView('landing')}
                        />
                    )}
                    
                    {view === 'setup' && (
                        <SetupWizard 
                            initialCompany={config?.company}
                            onComplete={(data) => {
                                setConfig(data);
                                setView('interview');
                            }} 
                            onBack={() => setView('landing')}
                        />
                    )}

                    {view === 'interview' && (
                        <InterviewRoom 
                            config={config} 
                            onEnd={() => handleFinishInterview(config)} 
                        />
                    )}

                    {view === 'results' && (
                        <ResultsPage 
                            config={config} 
                            onRestart={() => setView('landing')} 
                        />
                    )}
                </div>
            );
        };

        const root = ReactDOM.createRoot(document.getElementById('root'));
        root.render(<App />);
    </script>
</body>
</html>

